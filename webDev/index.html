<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../styles/reset.css">
    <link rel="stylesheet" href="../styles/topnav.css">
    <link rel="stylesheet" href="../styles/contact.css">
    <title>Web Development Projects</title>
    <style>
        body {
            padding-bottom: 32px;
        }
        #projTitle {
            font-size: 20px;
            display: flex;
            justify-content: center;
            margin: 8px 0;

        }

        #projCont {
            margin: 0 24px 8px;

            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
            
        }

        #allProjBtn {
            margin-top: 32px;
        }
        .allProj {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            width: 250px;
            margin:0 auto;
            padding: .9em 2em;
            overflow: hidden;
            border: 1px solid rgb(0, 127, 255);
            border-radius: 5px;
            background-color: #fff;
            color: rgb(0, 127, 255);
            font-size: 1em;
        }

        .allProj:hover {
            background-color: transparent;
            color: #fff;
        }

        .allProj::before {
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
            width: 0;
            height: 100%;
            background-color: rgb(0, 127, 255);
            content: '';
            transition: width .3s ease;
        }

        .allProj:hover::before {
            width: 100%;
        }

        .allProj a{
            text-decoration: none;
            color: inherit;
        }

        .projCard {
            margin-top: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid rgb(54, 69, 79);
            color: rgb(54, 69, 79);
            cursor: pointer;
        }

        .projCard::before {
            background-color: rgb(54, 69, 79);
        }

        .projCard {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .projCard span {
            text-decoration: none;
        }

        .projCard img {
            width: 240px;
            height: 135px;
            object-fit: cover;
        }

        #pagination {
            display: flex;
            gap: 4px;
            justify-content: right;
            margin: 0 24px;
        
        }

        #pagination button {
            font-size: 16px;
            margin: auto 0;
            background-color: white;
            border-radius: 4px;
            padding: 0 8px;
            border: 0;
        }

        #pagination button:hover {
            background-color: black;
            color: white;
        }

        #pagination button:disabled:hover{
            background-color: white;
        }
    </style>
</head>
<body>
    <div id="topNav">
        <div class="navBtn">
            <a href="../">Home</a>
        </div>
        <div class="navBtn">
            <a href="#">Web Development</a>
        </div>
        <div class="navBtn navBtn-fill">
            <button onclick="window.open('../assets/files/Joven_Santos_Resume.pdf', '_blank')">Resume</button>
        </div>
        <div class="navBtn navBtn-fill">
            <button onclick="openContactModal()">Contact Me</button>
        </div>
    </div>
    
    <div id="projTitle">
        Web Development Projects
    </div>
    <div id="projCont">
        <!-- 
        <a href="view/#">
            <div class="projCard">
                <img src="" alt="">
                <span>Project Name</span>
            </div>
        </a>
        -->
    </div>
    <!--
    <div id="pagination">
        
        <span>Showing page # of #</span>
        <a href="(-1)">Prev</a>
        <a href="#">Go to page</a>
        <a href="(+1)">Next</a>
        
    </div>
    -->

    <div id="blackOverlay">
        <div id="contactModal">
            <span class="contactTitle">Contact Information</span>

            <div class="contactLine">
                <img src="../assets/email.png" alt="">
                <span>sjovencd@gmail.com</span>
                <button onclick="copyToClipboard(this)"><img src="../assets/copy.png" alt=""></button>
            </div>

            <div class="contactLine">
                <img src="../assets/telephone.png" alt="">
                <span>+63 929 343 0291</span>
                <button onclick="copyToClipboard(this)"><img src="../assets/copy.png" alt=""></button>
            </div>

            <button class="closeBtn" onclick="document.getElementById('blackOverlay').style.display='none'">
                Close
            </button>
        </div>
    </div>

    <div id="toast">Copied!</div>
    
    <script src="../scipts/contact.js"></script>
    <script>
        let currentPage = 1;
        const projectsPerPage = 9;
        let allProjects = [];

        function loadProjects(containerId) {
        const container = document.getElementById(containerId);
        
        fetch('data.json')
            .then(response => {
            if (!response.ok) throw new Error('Network error');
            return response.json();
            })
            .then(projects => {
            allProjects = projects.reverse(); 
            renderPage(); 
            renderPagination(); 
            })
            .catch(error => {
            console.error('Error:', error);
            container.innerHTML = '<p>Error loading projects</p>';
            });
        }

        function renderPage() {
        const container = document.getElementById('projCont');
        container.innerHTML = '';
        
        const startIndex = (currentPage - 1) * projectsPerPage;
        const endIndex = startIndex + projectsPerPage;
        const pageProjects = allProjects.slice(startIndex, endIndex);
        
        pageProjects.forEach(project => {
            const projectCard = `
            <div class="projCont"> <!-- Unique container for each project -->
                <a href="view?id=${project.view}">
                <div class="projCard allProj">
                    <img src="${project.photoMain}" alt="${project.title}">
                    <span>${project.title}</span>
                </div>
                </a>
            </div>
            `;
            container.insertAdjacentHTML('beforeend', projectCard);
        });
        }

        function renderPagination() {
        const totalPages = Math.ceil(allProjects.length / projectsPerPage);
        const pagination = document.getElementById('pagination') || createPaginationElement();
        
        pagination.innerHTML = '';
        
        pagination.innerHTML += `<span> 
            Showing page ${currentPage} of ${totalPages} / 
            </span>`;

        pagination.innerHTML += `
            <button ${currentPage === 1 ? 'disabled' : ''} class="page-btn" onclick="changePage(-1)">
            Previous
            </button>
        `;

        pagination.innerHTML += `
            <${1 === currentPage ? 'span' : 'button onclick="goToPage(1)"'}>
            1
            <${1 === currentPage ? '/span' : '/button'} >
        `;
        
        if (currentPage > 1 && currentPage < totalPages) {
            pagination.innerHTML += `
                <span class="current-page">
                    ${currentPage}
                </span>
            `;
        }
        
        if (totalPages > 1) {
            pagination.innerHTML += `
            <${totalPages === currentPage ? 'span' : 'button'} 
                    onclick="goToPage(${totalPages})">
            ${totalPages}
            <${totalPages === currentPage ? '/span' : '/button'} >
            `;
        }
        
        pagination.innerHTML += `
            <button ${currentPage === totalPages ? 'disabled' : ''} class="page-btn" onclick="changePage(1)">
            Next
            </button>
        `;
        }

        function createPaginationElement() {
        const pagination = document.createElement('div');
        pagination.id = 'pagination';
        document.getElementById('projCont').after(pagination);
        return pagination;
        }

        function changePage(offset) {
        currentPage += offset;
        renderPage();
        renderPagination();
        }

        function goToPage(page) {
        currentPage = page;
        renderPage();
        renderPagination();
        }

        document.addEventListener('DOMContentLoaded', () => loadProjects('projCont'));
    </script>
</body>
</html>